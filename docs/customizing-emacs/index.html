<!DOCTYPE html>
<html><head><meta charset="utf-8"><link href="/main.css" rel="stylesheet"><link href="/extra/emacs.css" rel="stylesheet"><title>Emacs and extensibility - Homepage of Kaan Genç</title><link href="https://fonts.googleapis.com/css2?family=Ubuntu+Mono&amp;family=Ubuntu:ital,wght@0,400;0,700;1,400;1,700&amp;display=swap" rel="stylesheet"></head><div class="sidebar column"><a class="home" href="/">Home</a><img alt="A photo of Kaan Genç, after his OOPSLA 2019 talk." class="picture" src="/img/profile.jpg"><div class="name">Kaan Genç</div><div class="title">PhD Student</div><div class="department">Computer Science & Engineering</div><div class="affiliation">The Ohio State University</div><div class="spacer"></div><div class="title">Software Engineering Intern</div><div class="affiliation"><a href="http://dendron.so/">Dendron</a></div><div class="spacer"></div><span><a class="email" href="mailto:genc.5@osu.edu">genc.5@osu.edu</a><a class="gpg" href="/extra/kaangenc.gpg">GPG key</a></span><a class="github" href="https://github.com/SeriousBug">Github</a><a class="linkedin" href="https://www.linkedin.com/in/kaan-genc-8489b9205/">LinkedIn</a><a class="cv" href="/extra/cv.pdf">CV</a><a class="blog" href="/blog/">Blog</a><a class="twitter" href="https://twitter.com/KaanGencCS">Twitter</a><a class="researchr" href="https://conf.researchr.org/profile/kaangenc">Researchr</a></div><div class="main column"><h1 class="post-title">Emacs and extensibility</h1><div class="date">Written at Oct 5, 2015</div><div class="ttr">645 words, takes about 6 minutes to read</div><p>Update: I’ve put the small Emacs tools I have written to a <a href="https://gist.github.com/91c38ddde617b98ffbcb">gist</a>.</p>
<p>I have been using Emacs for some time, and I really love it. The amount of power it has, and the customizability is incredible. What other editor allow you to connect to a server over SSH and edit files, which is what I am doing to write this post. How many editors or IDE’s have support for so many languages?</p>
<!--more-->
<p>One thing I didn’t know in the past, however, is extensibility of Emacs. I mean, I do use a lot of packages, but I had never written Elisp and I didn’t know how hard or easy it would be. But after starting to learn Clojure a bit, and feeling more comfortable with lots of parenthesis, I decided to extend Emacs a bit to make it fit myself better.</p>
<p>The first thing I added is an “insert date” function. I use Emacs to take notes during lessons -using Org-mode- and I start every note with the date of the lesson. Sure, glancing at the date to the corner of my screen and writing it down takes just a few seconds, but why not write a command to do it for me? Here is what I came up with:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode commonlisp"><code class="sourceCode commonlisp"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">defun</span><span class="fu"> insert-current-date </span>()</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;Insert the current date in YYYY-MM-DD format.&quot;</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  (interactive)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  (shell-command <span class="st">&quot;date +&#39;%Y-%m-%d&#39;&quot;</span> <span class="kw">t</span>))</span></code></pre></div>
<p>Now that was easy and convenient. And being able to write my first piece of Elisp so easily was really fun, so I decided to tackle something bigger.</p>
<p>It is not rare that I need to compile and run a single C file. Nothing fancy, no libraries, no makefile, just a single C file to compile and run. I searched around the internet like “Emacs compile and run C”, but couldn’t find anything. I had been doing this by opening a shell in Emacs and compiling/running the program, but again, why not automate it?</p>
<p>The code that follows is not really good. “It works” is as good as it gets really, and actually considering that this is the first substantial Elisp I have written, that is pretty impressive -for the language and Emacs, which are both very helpful and powerful- I think.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode commonlisp"><code class="sourceCode commonlisp"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">require</span> &#39;s)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>(<span class="kw">defun</span><span class="fu"> compile-run-buffer </span>()</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;Compile and run buffer.&quot;</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  (interactive)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  (<span class="kw">let*</span> ((split-file-path (split-string buffer-file-name <span class="st">&quot;/&quot;</span>))</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>         (file-name (<span class="kw">car</span> (<span class="kw">last</span> split-file-path)))</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>         (file-name-noext (<span class="kw">car</span> (split-string file-name <span class="st">&quot;[.]&quot;</span>)))</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>         (buffer-name (concat <span class="st">&quot;compile-run: &quot;</span> file-name-noext))</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>         (buffer-name* (concat <span class="st">&quot;*&quot;</span> buffer-name <span class="st">&quot;*&quot;</span>)))</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>    (make-comint buffer-name <span class="st">&quot;gcc&quot;</span> <span class="kw">nil</span> <span class="st">&quot;-Wall&quot;</span> <span class="st">&quot;-Wextra&quot;</span> <span class="st">&quot;-o&quot;</span> file-name-noext file-name)</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>    (switch-to-buffer-other-window buffer-name*)</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>    (set-process-sentinel (get-buffer-process (current-buffer))</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>                          (apply-partially</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>                           &#39;(<span class="kw">lambda</span> (prog-name proc even)</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>                              (<span class="kw">if</span> (s-suffix? <span class="st">&quot;finished</span><span class="sc">\n</span><span class="st">&quot;</span> even)</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>                                  (<span class="kw">progn</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>                                    (insert <span class="st">&quot;Compilation successful.</span><span class="sc">\n\n</span><span class="st">&quot;</span>)</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>                                    (comint-exec (current-buffer) prog-name (concat <span class="st">&quot;./&quot;</span> prog-name) <span class="kw">nil</span> <span class="kw">nil</span>))</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>                                (insert (concat <span class="st">&quot;Compilation failed!</span><span class="sc">\n</span><span class="st">&quot;</span> even))))</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>                           file-name-noext))))</span></code></pre></div>
<p>Again, the code is not really good. I’m uploading it here right now because I’m actually very excited that I wrote this. Just now I can think of ways to improve this, for example moving the compiler and the flags to variables so that they can be customized. I could also improve the presentation, because strings printed by this function, comint and the running programs mixes up. I’ll update this blog post if I get to updating the code.</p>
<p>If this is your first time hearing about Emacs, this post may look very confusing. I don’t to Emacs any justice here, so do check it out somewhere like <a href="http://emacsrocks.com/">Emacs rocks</a>. On the other hand, if you have been looking a functionality like this, hope this helps. If you have any suggestions about the code, I’d love to hear them, you can find my email on the “about me” page. Anyway, have a good day!</p>
</div></html>